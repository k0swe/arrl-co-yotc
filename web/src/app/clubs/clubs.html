<div class="clubs-container">
  <header class="page-header">
    <div class="header-content">
      <div class="header-text">
        <h1>Colorado Amateur Radio Clubs</h1>
        <p class="subtitle">
          Browse and confirm your club membership to participate in Year of the Club activities
        </p>
      </div>
      @if (isAuthenticated()) {
      <button
        mat-raised-button
        color="accent"
        (click)="openAddClubDialog()"
        class="add-club-button"
        aria-label="Suggest a new club"
      >
        <mat-icon>add</mat-icon>
        <span>Suggest a Club</span>
      </button>
      }
    </div>

    <mat-form-field appearance="outline" class="filter-field">
      <mat-label>Filter clubs</mat-label>
      <input
        matInput
        [(ngModel)]="filterText"
        placeholder="Search by name, callsign, or location"
        aria-label="Filter clubs by name, callsign, or location"
      />
      <mat-icon matPrefix>search</mat-icon>
      @if (filterText()) {
      <button
        mat-icon-button
        matSuffix
        (click)="filterText.set('')"
        aria-label="Clear filter"
      >
        <mat-icon>clear</mat-icon>
      </button>
      }
    </mat-form-field>
  </header>

  @if (loading()) {
  <div class="loading-container" role="status" aria-live="polite">
    <mat-spinner></mat-spinner>
    <p>Loading clubs...</p>
  </div>
  } @else if (filteredClubs().length === 0 && !filterText()) {
  <div class="empty-state" role="status">
    <mat-icon class="empty-icon">groups_off</mat-icon>
    <h2>No Clubs Available</h2>
    <p>There are currently no active clubs registered in the system.</p>
  </div>
  } @else if (filteredClubs().length === 0 && filterText()) {
  <div class="empty-state" role="status">
    <mat-icon class="empty-icon">search_off</mat-icon>
    <h2>No Matching Clubs</h2>
    <p>No clubs match your search. Try a different search term.</p>
  </div>
  } @else {
  <div class="clubs-grid">
    @for (club of filteredClubs(); track club.id) {
    <app-club-card [club]="club">
      <div card-content>
        @if (club.membershipStatus) {
        <mat-chip-set aria-label="Membership status">
          <mat-chip [highlighted]="club.membershipStatus === MembershipStatus.Active">
            <mat-icon matChipAvatar>
              @switch (club.membershipStatus) { @case (MembershipStatus.Pending) {
              <span>schedule</span>
              } @case (MembershipStatus.Active) {
              <span>check_circle</span>
              } @case (MembershipStatus.Denied) {
              <span>cancel</span>
              } @case (MembershipStatus.Inactive) {
              <span>remove_circle</span>
              } }
            </mat-icon>
            {{ getMembershipStatusText(club.membershipStatus) }}
          </mat-chip>
        </mat-chip-set>
        }
      </div>

      <div card-actions>
        @if (canApply(club)) {
        <button
          mat-raised-button
          color="primary"
          (click)="applyForMembership(club)"
          [disabled]="club.isApplying"
          aria-label="Confirm membership in {{ club.name }}"
        >
          <mat-icon>verified_user</mat-icon>
          <span>Confirm Membership</span>
        </button>
        } @else if (!isAuthenticated()) {
        <button mat-button disabled aria-label="Sign in required to confirm">
          <mat-icon>lock</mat-icon>
          <span>Sign in to Confirm</span>
        </button>
        }
      </div>
    </app-club-card>
    }
  </div>
  }
</div>
