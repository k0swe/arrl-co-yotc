<mat-toolbar color="primary">
  <button mat-icon-button (click)="toggleSidenav()" aria-label="Toggle navigation">
    <mat-icon>menu</mat-icon>
  </button>
  <img ngSrc="/Colorado_WAS250.svg" alt="App Logo" class="app-logo" width="48" height="48" priority />
  <span>{{ title() }}</span>

  <span class="spacer"></span>

  @if (authService.isAuthenticated()) {
  <button mat-icon-button [matMenuTriggerFor]="userMenu" aria-label="User menu">
    <mat-icon>account_circle</mat-icon>
  </button>
  <mat-menu #userMenu="matMenu">
    <div class="user-info" mat-menu-item disabled>
      <mat-icon>email</mat-icon>
      <span>{{ authService.currentUser()?.email }}</span>
    </div>
    <mat-divider></mat-divider>
    <button mat-menu-item (click)="signOut()">
      <mat-icon>logout</mat-icon>
      <span>Sign Out</span>
    </button>
  </mat-menu>
  } @else {
  <a mat-button routerLink="/login" aria-label="Sign in">
    <mat-icon>login</mat-icon>
    Sign In
  </a>
  }
</mat-toolbar>

<mat-sidenav-container class="sidenav-container">
  <mat-sidenav [opened]="sidenavOpened()" mode="side" class="sidenav">
    <mat-nav-list>
      <a mat-list-item routerLink="/" aria-label="Navigate to home">
        <mat-icon matListItemIcon>home</mat-icon>
        <span matListItemTitle>Home</span>
      </a>
      @if (hasConfirmedMemberships()) {
      <mat-expansion-panel class="nav-expansion-panel">
        <mat-expansion-panel-header class="nav-expansion-header">
          <mat-panel-title>
            <a mat-list-item routerLink="/clubs" aria-label="Navigate to clubs">
              <mat-icon matListItemIcon>groups</mat-icon>
              <span matListItemTitle>Clubs</span>
            </a>
          </mat-panel-title>
        </mat-expansion-panel-header>
        @for (club of userClubs(); track club.id) {
        <a
          mat-list-item
          [routerLink]="['/clubs', club.slug || club.id]"
          class="nested-nav-item"
          [attr.aria-label]="'Navigate to ' + club.name"
        >
          @if (club.logoUrl) {
          <img
            matListItemIcon
            [ngSrc]="club.logoUrl"
            [alt]="'Logo for ' + club.name"
            width="24"
            height="24"
            class="club-logo-icon"
          />
          } @else {
          <mat-icon matListItemIcon>groups</mat-icon>
          }
          <span matListItemTitle>{{ club.name }}</span>
        </a>
        }
      </mat-expansion-panel>
      } @else {
      <a mat-list-item routerLink="/clubs" aria-label="Navigate to clubs">
        <mat-icon matListItemIcon>groups</mat-icon>
        <span matListItemTitle>Clubs</span>
      </a>
      }
      <a mat-list-item routerLink="/events" aria-label="Navigate to events">
        <mat-icon matListItemIcon>event</mat-icon>
        <span matListItemTitle>Events</span>
      </a>
      <a mat-list-item routerLink="/standings" aria-label="Navigate to standings">
        <mat-icon matListItemIcon>leaderboard</mat-icon>
        <span matListItemTitle>Standings</span>
      </a>
      @if (authService.isAdmin()) {
      <a
        mat-list-item
        routerLink="/admin"
        aria-label="Navigate to admin"
        [matBadge]="pendingClubsCount()"
        [matBadgeHidden]="pendingClubsCount() === 0"
        matBadgeColor="warn"
      >
        <mat-icon matListItemIcon>admin_panel_settings</mat-icon>
        <span matListItemTitle>Admin</span>
      </a>
      }
    </mat-nav-list>
  </mat-sidenav>

  <mat-sidenav-content class="main-content">
    <router-outlet />
  </mat-sidenav-content>
</mat-sidenav-container>
